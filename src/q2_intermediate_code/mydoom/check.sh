#!/bin/sh

tshark -r not_common.pcap -Y "ip.addr in {118.129.22.83 11.85.145.177 155.160.69.223 66.252.209.43 132.201.172.28 214.79.15.107 85.66.116.26 192.197.115.238 13.62.120.217 233.135.17.164 45.73.58.186 220.108.180.170 254.22.70.71 86.170.170.130 29.46.48.78 37.143.23.6} and dns.qry.type == 15" -T fields -e dns.qry.name | sort -u > /tmp/a.txt

tshark -r not_common.pcap -Y "ip.addr in {118.129.22.83 11.85.145.177 155.160.69.223 66.252.209.43 132.201.172.28 214.79.15.107 85.66.116.26 192.197.115.238 13.62.120.217 233.135.17.164 45.73.58.186 220.108.180.170 254.22.70.71 86.170.170.130 29.46.48.78 37.143.23.6} and dns.qry.type == 1" -T fields -e dns.qry.name | sort -u > /tmp/b.txt

comm -13 /tmp/a.txt /tmp/b.txt | awk -F, '{if(!($1 ~ /^[aehmnpqrsw]{10}\.(com|biz|us|net|org|ws|info|in)$/)) print "ERROR", $0}' 